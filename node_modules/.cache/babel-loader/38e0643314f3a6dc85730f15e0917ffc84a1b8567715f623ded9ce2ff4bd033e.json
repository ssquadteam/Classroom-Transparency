{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import'./Chatroom.css';import io from'socket.io-client';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const socket=io('https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443');const Chatroom=_ref=>{let{user}=_ref;const[messages,setMessages]=useState([]);const[input,setInput]=useState('');const[image,setImage]=useState(null);const[previewImage,setPreviewImage]=useState(null);const[editingMessageId,setEditingMessageId]=useState(null);const[editInput,setEditInput]=useState('');const[activeDropdown,setActiveDropdown]=useState(null);const[newMessages,setNewMessages]=useState(0);const[isAtBottom,setIsAtBottom]=useState(true);const dropdownRef=useRef(null);const messagesEndRef=useRef(null);const chatContainerRef=useRef(null);useEffect(()=>{fetch('https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443/messages').then(response=>response.json()).then(data=>setMessages(data.messages));setTimeout(()=>{document.querySelector('.chatroom').classList.add('visible');},100);},[]);useEffect(()=>{const handleClickOutside=event=>{if(dropdownRef.current&&!dropdownRef.current.contains(event.target)){setActiveDropdown(null);}};document.addEventListener('mousedown',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[]);useEffect(()=>{const checkIfAtBottom=()=>{if(chatContainerRef.current){const{scrollTop,scrollHeight,clientHeight}=chatContainerRef.current;const atBottom=Math.abs(scrollHeight-scrollTop-clientHeight)<1;setIsAtBottom(atBottom);return atBottom;}return false;};if(isAtBottom){scrollToBottom();}else{setNewMessages(prev=>prev+1);}},[messages]);useEffect(()=>{if(isAtBottom){scrollToBottom();}},[messages,isAtBottom]);useEffect(()=>{socket.on('message',message=>{setMessages(prevMessages=>{if(!prevMessages.some(msg=>msg.id===message.id)){return[...prevMessages,message];}return prevMessages;});});socket.on('deleteMessage',messageId=>{setMessages(prevMessages=>prevMessages.filter(message=>message.id!==messageId));});socket.on('editMessage',editedMessage=>{setMessages(prevMessages=>prevMessages.map(message=>message.id===editedMessage.id?{...message,...editedMessage}:message));});return()=>{socket.off('message');socket.off('deleteMessage');socket.off('editMessage');};},[]);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});setNewMessages(0);};const handleNewMessagesClick=()=>{scrollToBottom();};const handleSendMessage=()=>{if(input.trim()!==''||image){const formData=new FormData();formData.append('text',input);formData.append('user',user.name);formData.append('userId',user.id);formData.append('timestamp',new Date().toISOString());if(image){formData.append('image',image);}console.log('Sending message:',{text:input,user:user.name,userId:user.id,timestamp:new Date().toISOString(),image});fetch('https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443/messages',{method:'POST',body:formData}).then(response=>{if(!response.ok){throw new Error('Network response was not ok');}return response.json();}).then(data=>{console.log('Message sent successfully:',data);setInput('');setImage(null);setPreviewImage(null);}).catch(error=>{console.error('Error:',error);});}};const handleDeleteMessage=messageId=>{if(user.admin||messages.find(msg=>msg.id===messageId).userId===user.id){fetch(`https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443/messages/${messageId}`,{method:'DELETE'}).then(response=>response.json()).then(data=>{if(data.deleted){setMessages(messages.filter(message=>message.id!==messageId));socket.emit('deleteMessage',messageId);}else{alert('Failed to delete the message.');}});}else{alert('You do not have permission to delete this message.');}};const handleEditMessage=(messageId,newText)=>{const now=new Date();const message=messages.find(msg=>msg.id===messageId);const messageTime=new Date(message.timestamp);const timeDiff=(now-messageTime)/(1000*60);if(timeDiff<=5){const editedMessage={...message,text:newText};setMessages(messages.map(msg=>msg.id===messageId?editedMessage:msg));socket.emit('editMessage',editedMessage);setEditingMessageId(null);}else{alert('You can only edit messages up to 5 minutes old.');}};const handleImageUpload=event=>{const file=event.target.files[0];setImage(file);setPreviewImage(URL.createObjectURL(file));};const startEditing=(messageId,text)=>{setEditingMessageId(messageId);setEditInput(text);};const toggleDropdown=(messageId,event)=>{event.stopPropagation();setActiveDropdown(prevActiveDropdown=>prevActiveDropdown===messageId?null:messageId);};return/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Grade-IX Chat Room\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom-messages\",ref:chatContainerRef,children:[/*#__PURE__*/_jsxs(\"div\",{className:`chatroom-new-messages ${newMessages>0&&!isAtBottom?'visible':''}`,onClick:handleNewMessagesClick,children:[newMessages,\" New Messages Below\"]}),messages.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"chatroom-welcome\",children:\"Send a message to get started\"}):messages.map(message=>/*#__PURE__*/_jsx(\"div\",{className:\"chatroom-message\",children:editingMessageId===message.id?/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom-edit-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editInput,onChange:e=>setEditInput(e.target.value),className:\"chatroom-edit-input\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEditMessage(message.id,editInput),children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingMessageId(null),children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom-message-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom-message-text\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"chatroom-username\",children:message.user}),\" \",message.text,message.imagePath&&/*#__PURE__*/_jsx(\"img\",{src:`https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443/${message.imagePath}`,alt:\"Uploaded\",className:\"chatroom-image\"})]}),(user.admin||message.userId===user.id)&&/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom-message-actions\",ref:activeDropdown===message.id?dropdownRef:null,children:[/*#__PURE__*/_jsxs(\"button\",{className:\"chatroom-message-actions-button\",onClick:e=>toggleDropdown(message.id,e),children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]}),activeDropdown===message.id&&/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom-message-actions-dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEditing(message.id,message.text),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteMessage(message.id),children:\"Delete\"})]})]})]})},message.id)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),previewImage&&/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom-preview-image\",children:[/*#__PURE__*/_jsx(\"img\",{src:previewImage,alt:\"Preview\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setImage(null);setPreviewImage(null);},children:\"\\u274C\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chatroom-input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleImageUpload,id:\"imageUpload\",style:{display:'none'}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"imageUpload\",className:\"chatroom-button\",children:\"\\uD83D\\uDCCE\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:input,onChange:e=>setInput(e.target.value),className:\"chatroom-input\",placeholder:\"Type a message...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,className:\"chatroom-send-button\",children:\"Send\"})]})]});};export default Chatroom;","map":{"version":3,"names":["React","useState","useEffect","useRef","io","jsx","_jsx","jsxs","_jsxs","socket","Chatroom","_ref","user","messages","setMessages","input","setInput","image","setImage","previewImage","setPreviewImage","editingMessageId","setEditingMessageId","editInput","setEditInput","activeDropdown","setActiveDropdown","newMessages","setNewMessages","isAtBottom","setIsAtBottom","dropdownRef","messagesEndRef","chatContainerRef","fetch","then","response","json","data","setTimeout","document","querySelector","classList","add","handleClickOutside","event","current","contains","target","addEventListener","removeEventListener","checkIfAtBottom","scrollTop","scrollHeight","clientHeight","atBottom","Math","abs","scrollToBottom","prev","on","message","prevMessages","some","msg","id","messageId","filter","editedMessage","map","off","_messagesEndRef$curre","scrollIntoView","behavior","handleNewMessagesClick","handleSendMessage","trim","formData","FormData","append","name","Date","toISOString","console","log","text","userId","timestamp","method","body","ok","Error","catch","error","handleDeleteMessage","admin","find","deleted","emit","alert","handleEditMessage","newText","now","messageTime","timeDiff","handleImageUpload","file","files","URL","createObjectURL","startEditing","toggleDropdown","stopPropagation","prevActiveDropdown","className","children","ref","onClick","length","type","value","onChange","e","imagePath","src","alt","style","display","htmlFor","placeholder"],"sources":["/home/sadatsahib/Projects/School/src/components/Chatroom.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport './Chatroom.css';\nimport io from 'socket.io-client';\n\nconst socket = io('https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443');\n\nconst Chatroom = ({ user }) => {\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [image, setImage] = useState(null);\n  const [previewImage, setPreviewImage] = useState(null);\n  const [editingMessageId, setEditingMessageId] = useState(null);\n  const [editInput, setEditInput] = useState('');\n  const [activeDropdown, setActiveDropdown] = useState(null);\n  const [newMessages, setNewMessages] = useState(0);\n  const [isAtBottom, setIsAtBottom] = useState(true);\n  const dropdownRef = useRef(null);\n  const messagesEndRef = useRef(null);\n  const chatContainerRef = useRef(null);\n\n  useEffect(() => {\n    fetch('https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443/messages')\n      .then((response) => response.json())\n      .then((data) => setMessages(data.messages));\n\n    setTimeout(() => {\n      document.querySelector('.chatroom').classList.add('visible');\n    }, 100);\n  }, []);\n\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\n        setActiveDropdown(null);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  useEffect(() => {\n    const checkIfAtBottom = () => {\n      if (chatContainerRef.current) {\n        const { scrollTop, scrollHeight, clientHeight } = chatContainerRef.current;\n        const atBottom = Math.abs(scrollHeight - scrollTop - clientHeight) < 1;\n        setIsAtBottom(atBottom);\n        return atBottom;\n      }\n      return false;\n    };\n  \n    if (isAtBottom) {\n      scrollToBottom();\n    } else {\n      setNewMessages(prev => prev + 1);\n    }\n  }, [messages]);\n\n  useEffect(() => {\n    if (isAtBottom) {\n      scrollToBottom();\n    }\n  }, [messages, isAtBottom]);\n\n  useEffect(() => {\n    socket.on('message', (message) => {\n      setMessages((prevMessages) => {\n        if (!prevMessages.some(msg => msg.id === message.id)) {\n          return [...prevMessages, message];\n        }\n        return prevMessages;\n      });\n    });\n\n    socket.on('deleteMessage', (messageId) => {\n      setMessages((prevMessages) => \n        prevMessages.filter((message) => message.id !== messageId)\n      );\n    });\n\n    socket.on('editMessage', (editedMessage) => {\n      setMessages((prevMessages) =>\n        prevMessages.map((message) =>\n          message.id === editedMessage.id ? { ...message, ...editedMessage } : message\n        )\n      );\n    });\n\n    return () => {\n      socket.off('message');\n      socket.off('deleteMessage');\n      socket.off('editMessage');\n    };\n  }, []);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n    setNewMessages(0);\n  }\n\n  const handleNewMessagesClick = () => {\n    scrollToBottom();\n  }\n\n  const handleSendMessage = () => {\n    if (input.trim() !== '' || image) {\n      const formData = new FormData();\n      formData.append('text', input);\n      formData.append('user', user.name);\n      formData.append('userId', user.id);\n      formData.append('timestamp', new Date().toISOString());\n      if (image) {\n        formData.append('image', image);\n      }\n  \n      console.log('Sending message:', {\n        text: input,\n        user: user.name,\n        userId: user.id,\n        timestamp: new Date().toISOString(),\n        image,\n      });\n  \n      fetch('https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443/messages', {\n        method: 'POST',\n        body: formData,\n      })\n        .then((response) => {\n          if (!response.ok) {\n            throw new Error('Network response was not ok');\n          }\n          return response.json();\n        })\n        .then((data) => {\n          console.log('Message sent successfully:', data);\n          setInput('');\n          setImage(null);\n          setPreviewImage(null);\n        })\n        .catch((error) => {\n          console.error('Error:', error);\n        });\n    }\n  };\n\n  const handleDeleteMessage = (messageId) => {\n    if (user.admin || messages.find((msg) => msg.id === messageId).userId === user.id) {\n      fetch(`https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443/messages/${messageId}`, {\n        method: 'DELETE',\n      })\n        .then((response) => response.json())\n        .then((data) => {\n          if (data.deleted) {\n            setMessages(messages.filter((message) => message.id !== messageId));\n            socket.emit('deleteMessage', messageId);\n          } else {\n            alert('Failed to delete the message.');\n          }\n        });\n    } else {\n      alert('You do not have permission to delete this message.');\n    }\n  };\n\n  const handleEditMessage = (messageId, newText) => {\n    const now = new Date();\n    const message = messages.find((msg) => msg.id === messageId);\n    const messageTime = new Date(message.timestamp);\n    const timeDiff = (now - messageTime) / (1000 * 60);\n\n    if (timeDiff <= 5) {\n      const editedMessage = { ...message, text: newText };\n      setMessages(\n        messages.map((msg) =>\n          msg.id === messageId ? editedMessage : msg\n        )\n      );\n      socket.emit('editMessage', editedMessage);\n      setEditingMessageId(null);\n    } else {\n      alert('You can only edit messages up to 5 minutes old.');\n    }\n  };\n\n  const handleImageUpload = (event) => {\n    const file = event.target.files[0];\n    setImage(file);\n    setPreviewImage(URL.createObjectURL(file));\n  };\n\n  const startEditing = (messageId, text) => {\n    setEditingMessageId(messageId);\n    setEditInput(text);\n  };\n\n  const toggleDropdown = (messageId, event) => {\n    event.stopPropagation();\n    setActiveDropdown(prevActiveDropdown => \n      prevActiveDropdown === messageId ? null : messageId\n    );\n  };\n\n  return (\n    <div className=\"chatroom\">\n      <h2>Grade-IX Chat Room</h2>\n      <div className=\"chatroom-messages\" ref={chatContainerRef}>\n        <div className={`chatroom-new-messages ${newMessages > 0 && !isAtBottom ? 'visible' : ''}`} onClick={handleNewMessagesClick}>\n          {newMessages} New Messages Below\n        </div>\n        {messages.length === 0 ? (\n          <div className=\"chatroom-welcome\">Send a message to get started</div>\n        ) : (\n          messages.map((message) => (\n            <div key={message.id} className=\"chatroom-message\">\n              {editingMessageId === message.id ? (\n                <div className=\"chatroom-edit-container\">\n                  <input\n                    type=\"text\"\n                    value={editInput}\n                    onChange={(e) => setEditInput(e.target.value)}\n                    className=\"chatroom-edit-input\"\n                  />\n                  <button onClick={() => handleEditMessage(message.id, editInput)}>Save</button>\n                  <button onClick={() => setEditingMessageId(null)}>Cancel</button>\n                </div>\n              ) : (\n                <div className=\"chatroom-message-content\">\n                  <div className=\"chatroom-message-text\">\n                    <span className=\"chatroom-username\">{message.user}</span> {message.text}\n                    {message.imagePath && (\n                      <img \n                        src={`https://6711c250-f6ca-4f9f-a6e2-2b3df23ce26f-00-3paa249pb63vs.sisko.replit.dev:443/${message.imagePath}`} \n                        alt=\"Uploaded\" \n                        className=\"chatroom-image\" \n                      />\n                    )}\n                  </div>\n                  {(user.admin || message.userId === user.id) && (\n                    <div className=\"chatroom-message-actions\" ref={activeDropdown === message.id ? dropdownRef : null}>\n                      <button \n                        className=\"chatroom-message-actions-button\"\n                        onClick={(e) => toggleDropdown(message.id, e)}\n                      >\n                        <span></span>\n                        <span></span>\n                        <span></span>\n                      </button>\n                      {activeDropdown === message.id && (\n                        <div className=\"chatroom-message-actions-dropdown\">\n                          <button onClick={() => startEditing(message.id, message.text)}>Edit</button>\n                          <button onClick={() => handleDeleteMessage(message.id)}>Delete</button>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          ))\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n      {previewImage && (\n        <div className=\"chatroom-preview-image\">\n          <img src={previewImage} alt=\"Preview\" />\n          <button onClick={() => {setImage(null); setPreviewImage(null);}}>‚ùå</button>\n        </div>\n      )}\n      <div className=\"chatroom-input-container\">\n        <input\n          type=\"file\"\n          onChange={handleImageUpload}\n          id=\"imageUpload\"\n          style={{ display: 'none' }}\n        />\n        <label htmlFor=\"imageUpload\" className=\"chatroom-button\">üìé</label>\n        <input\n          type=\"text\"\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          className=\"chatroom-input\"\n          placeholder=\"Type a message...\"\n        />\n        <button onClick={handleSendMessage} className=\"chatroom-send-button\">Send</button>\n      </div>\n    </div>\n  );\n};\n\nexport default Chatroom;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}